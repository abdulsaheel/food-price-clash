<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Search</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .price-comparison-bar {
            height: 8px;
            background: linear-gradient(90deg, #4f46e5 50%, #10b981 50%);
            background-size: 200% 100%;
            border-radius: 4px;
            margin: 8px 0;
        }
        .cheaper-indicator {
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid;
            position: absolute;
            bottom: -8px;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold text-center mb-8 text-indigo-700">Food Search</h1>
        
        <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-md p-6 mb-8">
            <form id="searchForm" class="space-y-4">
                <div>
                    <label for="location" class="block text-sm font-medium text-gray-700 mb-1">Location</label>
                    <select id="location" name="location" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" 
                           required>
                        <option value="">Select a location</option>
                        <option value="Agra">Agra</option>
                        <option value="Ahmedabad">Ahmedabad</option>
                        <option value="Ajmer">Ajmer</option>
                        <option value="Alappuzha">Alappuzha</option>
                        <option value="Allahabad">Allahabad</option>
                        <option value="Amravati">Amravati</option>
                        <option value="Amritsar">Amritsar</option>
                        <option value="Aurangabad">Aurangabad</option>
                        <option value="Bengaluru">Bengaluru</option>
                        <option value="Bhopal">Bhopal</option>
                        <option value="Bhubaneswar">Bhubaneswar</option>
                        <option value="Chandigarh">Chandigarh</option>
                        <option value="Chennai">Chennai</option>
                        <option value="Coimbatore">Coimbatore</option>
                        <option value="Cuttack">Cuttack</option>
                        <option value="Darjeeling">Darjeeling</option>
                        <option value="Dehradun">Dehradun</option>
                        <option value="Delhi NCR">Delhi NCR</option>
                        <option value="Dharamshala">Dharamshala</option>
                        <option value="Gangtok">Gangtok</option>
                        <option value="Goa">Goa</option>
                        <option value="Gorakhpur">Gorakhpur</option>
                        <option value="Guntur">Guntur</option>
                        <option value="Guwahati">Guwahati</option>
                        <option value="Gwalior">Gwalior</option>
                        <option value="Haridwar">Haridwar</option>
                        <option value="Hyderabad" selected>Hyderabad</option>
                        <option value="Indore">Indore</option>
                        <option value="Jabalpur">Jabalpur</option>
                        <option value="Jaipur">Jaipur</option>
                        <option value="Jalandhar">Jalandhar</option>
                        <option value="Jammu">Jammu</option>
                        <option value="Jamnagar">Jamnagar</option>
                        <option value="Jamshedpur">Jamshedpur</option>
                        <option value="Jhansi">Jhansi</option>
                        <option value="Jodhpur">Jodhpur</option>
                        <option value="Junagadh">Junagadh</option>
                        <option value="Kanpur">Kanpur</option>
                        <option value="Khajuraho">Khajuraho</option>
                        <option value="Khamgaon">Khamgaon</option>
                        <option value="Kharagpur">Kharagpur</option>
                        <option value="Kochi">Kochi</option>
                        <option value="Kolhapur">Kolhapur</option>
                        <option value="Kolkata">Kolkata</option>
                        <option value="Kota">Kota</option>
                        <option value="Lucknow">Lucknow</option>
                        <option value="Ludhiana">Ludhiana</option>
                        <option value="Madurai">Madurai</option>
                        <option value="Manali">Manali</option>
                        <option value="Mangalore">Mangalore</option>
                        <option value="Manipal">Manipal</option>
                        <option value="Meerut">Meerut</option>
                        <option value="Mumbai">Mumbai</option>
                        <option value="Mussoorie">Mussoorie</option>
                        <option value="Mysore">Mysore</option>
                        <option value="Nagpur">Nagpur</option>
                        <option value="Nainital">Nainital</option>
                        <option value="Nashik">Nashik</option>
                        <option value="Neemrana">Neemrana</option>
                        <option value="Ooty">Ooty</option>
                        <option value="Palakkad">Palakkad</option>
                        <option value="Patiala">Patiala</option>
                        <option value="Patna">Patna</option>
                        <option value="Puducherry">Puducherry</option>
                        <option value="Pune">Pune</option>
                        <option value="Pushkar">Pushkar</option>
                        <option value="Raipur">Raipur</option>
                        <option value="Rajkot">Rajkot</option>
                        <option value="Ranchi">Ranchi</option>
                        <option value="Rishikesh">Rishikesh</option>
                        <option value="Salem">Salem</option>
                        <option value="Shimla">Shimla</option>
                        <option value="Siliguri">Siliguri</option>
                        <option value="Srinagar">Srinagar</option>
                        <option value="Surat">Surat</option>
                        <option value="Thrissur">Thrissur</option>
                        <option value="Tirupati">Tirupati</option>
                        <option value="Trichy">Trichy</option>
                        <option value="Trivandrum">Trivandrum</option>
                        <option value="Udaipur">Udaipur</option>
                        <option value="Vadodara">Vadodara</option>
                        <option value="Varanasi">Varanasi</option>
                        <option value="Vellore">Vellore</option>
                        <option value="Vijayawada">Vijayawada</option>
                        <option value="Visakhapatnam">Visakhapatnam</option>
                    </select>
                </div>
                <div>
                    <label for="food_item" class="block text-sm font-medium text-gray-700 mb-1">Food Item</label>
                    <select id="food_item" name="food_item" 
                           class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" 
                           required>
                        <option value="">Select a food item</option>
                        <option value="biryani">Biryani</option>
                        <option value="pizza" selected>Pizza</option>
                        <option value="Chicken">Chicken</option>
                        <option value="burger">Burger</option>
                        <option value="ice-cream">Ice Cream</option>
                        <option value="fried-rice">Fried Rice</option>
                        <option value="shawarma">Shawarma</option>
                        <option value="noodles">Noodles</option>
                        <option value="rolls">Rolls</option>
                        <option value="thali">Thali</option>
                    </select>
                </div>
                <button type="submit" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition duration-200 flex items-center justify-center">
                    <i class="fas fa-search mr-2"></i> Search
                </button>
            </form>
        </div>

        <!-- Rest of the HTML remains unchanged -->
        <div id="loading" class="text-center hidden">
            <div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-600 mb-2"></div>
            <p class="text-gray-600">Searching for delicious options...</p>
        </div>

        <div id="results" class="hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-semibold text-gray-800">Search Results</h2>
                <div class="flex space-x-2">
                    <button id="showCommon" class="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition">Common</button>
                    <button id="showSwiggy" class="px-4 py-2 bg-indigo-400 text-white rounded-md hover:bg-indigo-500 transition">Swiggy</button>
                    <button id="showZomato" class="px-4 py-2 bg-green-400 text-white rounded-md hover:bg-green-500 transition">Zomato</button>
                </div>
            </div>

            <div id="commonResults" class="space-y-6">
                <!-- Common results will be inserted here -->
            </div>

            <div id="swiggyResults" class="space-y-6 hidden">
                <!-- Swiggy results will be inserted here -->
            </div>

            <div id="zomatoResults" class="space-y-6 hidden">
                <!-- Zomato results will be inserted here -->
            </div>
        </div>

        <div id="noResults" class="hidden text-center py-12">
            <i class="fas fa-utensils text-5xl text-gray-300 mb-4"></i>
            <h3 class="text-xl font-medium text-gray-600">No results found</h3>
            <p class="text-gray-500">Try a different search term or location</p>
        </div>
    </div>

    <script>
        document.getElementById('searchForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const location = document.getElementById('location').value;
            const foodItem = document.getElementById('food_item').value;
            
            // Show loading state
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('results').classList.add('hidden');
            document.getElementById('noResults').classList.add('hidden');
            
            try {
                const response = await fetch('http://127.0.0.1:8000/search', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        location: location,
                        food_item: foodItem
                    })
                });
                
                const data = await response.json();
                
                // Hide loading
                document.getElementById('loading').classList.add('hidden');
                
                if ((!data.swiggy_results || data.swiggy_results.length === 0) && 
                    (!data.zomato_results || data.zomato_results.length === 0)) {
                    document.getElementById('noResults').classList.remove('hidden');
                    return;
                }
                
                // Display results with Common tab first
                displayResults(data);
                document.getElementById('results').classList.remove('hidden');
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('noResults').classList.remove('hidden');
            }
        });

        function displayResults(data) {
            const swiggyContainer = document.getElementById('swiggyResults');
            const commonContainer = document.getElementById('commonResults');
            const zomatoContainer = document.getElementById('zomatoResults');
            
            // Clear previous results
            swiggyContainer.innerHTML = '';
            commonContainer.innerHTML = '';
            zomatoContainer.innerHTML = '';
            
            // Process Swiggy results
            const swiggyItems = [];
            if (data.swiggy_results && data.swiggy_results.length > 0) {
                data.swiggy_results.forEach(item => {
                    if (item.Restaurant === "N/A") return;
                    swiggyItems.push(item);
                    const card = createSwiggyCard(item);
                    swiggyContainer.appendChild(card);
                });
            } else {
                swiggyContainer.innerHTML = '<p class="text-gray-500 text-center py-8">No Swiggy results found</p>';
            }
            
            // Process Zomato results
            const zomatoItems = [];
            if (data.zomato_results && data.zomato_results.length > 0) {
                data.zomato_results.forEach(item => {
                    if (item.Name === "N/A") return;
                    zomatoItems.push(item);
                    const card = createZomatoCard(item);
                    zomatoContainer.appendChild(card);
                });
            } else {
                zomatoContainer.innerHTML = '<p class="text-gray-500 text-center py-8">No Zomato results found</p>';
            }
            
            // Find common restaurants with improved matching
            const commonRestaurants = findCommonRestaurants(swiggyItems, zomatoItems);
            
            // Display common results first
            if (commonRestaurants.length > 0) {
                commonRestaurants.forEach(pair => {
                    const card = createCommonCard(pair.swiggy, pair.zomato);
                    commonContainer.appendChild(card);
                });
            } else {
                commonContainer.innerHTML = '<p class="text-gray-500 text-center py-8">No common restaurants found. Showing Swiggy results instead.</p>';
                // If no common results, show Swiggy by default
                document.getElementById('commonResults').classList.add('hidden');
                document.getElementById('swiggyResults').classList.remove('hidden');
                updateActiveTab('swiggy');
                return;
            }
            
            // Set up tab switching
            document.getElementById('showCommon').addEventListener('click', () => {
                document.getElementById('commonResults').classList.remove('hidden');
                document.getElementById('swiggyResults').classList.add('hidden');
                document.getElementById('zomatoResults').classList.add('hidden');
                updateActiveTab('common');
            });
            
            document.getElementById('showSwiggy').addEventListener('click', () => {
                document.getElementById('commonResults').classList.add('hidden');
                document.getElementById('swiggyResults').classList.remove('hidden');
                document.getElementById('zomatoResults').classList.add('hidden');
                updateActiveTab('swiggy');
            });
            
            document.getElementById('showZomato').addEventListener('click', () => {
                document.getElementById('commonResults').classList.add('hidden');
                document.getElementById('swiggyResults').classList.add('hidden');
                document.getElementById('zomatoResults').classList.remove('hidden');
                updateActiveTab('zomato');
            });
            
            // Show Common by default
            updateActiveTab('common');
        }

        function updateActiveTab(activeTab) {
            // Reset all buttons
            document.getElementById('showSwiggy').classList.remove('bg-indigo-600', 'bg-indigo-400');
            document.getElementById('showCommon').classList.remove('bg-purple-600', 'bg-purple-400');
            document.getElementById('showZomato').classList.remove('bg-green-600', 'bg-green-400');
            
            // Set active button
            if (activeTab === 'swiggy') {
                document.getElementById('showSwiggy').classList.add('bg-indigo-600');
                document.getElementById('showCommon').classList.add('bg-purple-400');
                document.getElementById('showZomato').classList.add('bg-green-400');
            } else if (activeTab === 'common') {
                document.getElementById('showSwiggy').classList.add('bg-indigo-400');
                document.getElementById('showCommon').classList.add('bg-purple-600');
                document.getElementById('showZomato').classList.add('bg-green-400');
            } else {
                document.getElementById('showSwiggy').classList.add('bg-indigo-400');
                document.getElementById('showCommon').classList.add('bg-purple-400');
                document.getElementById('showZomato').classList.add('bg-green-600');
            }
        }

        function findCommonRestaurants(swiggyItems, zomatoItems) {
            const commonPairs = [];
            
            // Improved name normalization
            const normalizeName = (name) => {
                if (!name) return '';
                return name.toLowerCase()
                    .replace(/[^a-z0-9 ]/g, '') // Remove special chars
                    .replace(/\b(the|a|an|and|by|restaurant|cafe|hotel|bakery|pizza)\b/g, '') // Remove common words
                    .replace(/\s+/g, ' ') // Collapse multiple spaces
                    .trim();
            };
            
            // Create a map of normalized names to items
            const swiggyMap = new Map();
            swiggyItems.forEach(item => {
                const normalized = normalizeName(item.Restaurant);
                if (normalized) {
                    swiggyMap.set(normalized, item);
                }
            });
            
            // Try to find matches in Zomato results
            zomatoItems.forEach(zomatoItem => {
                const normalized = normalizeName(zomatoItem.Name);
                if (!normalized) return;
                
                // Check for exact match first
                if (swiggyMap.has(normalized)) {
                    commonPairs.push({
                        swiggy: swiggyMap.get(normalized),
                        zomato: zomatoItem
                    });
                    swiggyMap.delete(normalized); // Prevent duplicate matches
                    return;
                }
                
                // Check for partial matches if no exact match
                for (const [swiggyNormalized, swiggyItem] of swiggyMap) {
                    if (calculateSimilarity(swiggyNormalized, normalized) > 0.7) {
                        commonPairs.push({
                            swiggy: swiggyItem,
                            zomato: zomatoItem
                        });
                        swiggyMap.delete(swiggyNormalized);
                        break;
                    }
                }
            });
            
            return commonPairs;
        }

        // Calculate similarity between two strings (0-1) using Levenshtein distance
        function calculateSimilarity(str1, str2) {
            if (!str1 || !str2) return 0;
            
            // Convert to arrays of words
            const words1 = str1.split(' ');
            const words2 = str2.split(' ');
            
            // Count matching words
            const intersection = words1.filter(word => words2.includes(word));
            const union = [...new Set([...words1, ...words2])];
            
            // If at least one word matches, consider it
            if (intersection.length > 0) {
                return intersection.length / union.length;
            }
            
            // Fallback to character-based similarity
            const longer = str1.length > str2.length ? str1 : str2;
            const shorter = str1.length > str2.length ? str2 : str1;
            const longerLength = longer.length;
            
            if (longerLength === 0) return 1.0;
            
            return (longerLength - levenshteinDistance(longer, shorter)) / parseFloat(longerLength);
        }
        
        // Levenshtein distance implementation
        function levenshteinDistance(s, t) {
            if (s === t) return 0;
            if (s.length === 0) return t.length;
            if (t.length === 0) return s.length;
            
            const v0 = Array(t.length + 1).fill(0);
            const v1 = Array(t.length + 1).fill(0);
            
            for (let i = 0; i < v0.length; i++) {
                v0[i] = i;
            }
            
            for (let i = 0; i < s.length; i++) {
                v1[0] = i + 1;
                
                for (let j = 0; j < t.length; j++) {
                    const cost = s[i] === t[j] ? 0 : 1;
                    v1[j + 1] = Math.min(v1[j] + 1, v0[j + 1] + 1, v0[j] + cost);
                }
                
                for (let j = 0; j < v0.length; j++) {
                    v0[j] = v1[j];
                }
            }
            
            return v1[t.length];
        }

        function createSwiggyCard(item) {
            const card = document.createElement('div');
            card.className = 'bg-white rounded-lg shadow-md overflow-hidden';
            
            let imageHtml = '';
            if (item['Image URL'] && item['Image URL'] !== "N/A") {
                imageHtml = `
                    <div class="h-48 bg-gray-200 overflow-hidden">
                        <img src="${item['Image URL']}" alt="${item.Dish || 'Food item'}" class="w-full h-full object-cover">
                    </div>
                `;
            }
            
            const description = item.Description || 'No description available';
            const priceHtml = item['Discounted Price'] !== item['Original Price'] ? 
                `<span class="text-gray-500 line-through mr-2">₹${item['Original Price']}</span>
                 <span class="text-green-600 font-semibold">₹${item['Discounted Price']}</span>` :
                `<span class="text-gray-800 font-semibold">₹${item['Original Price']}</span>`;
            
            // Get Swiggy URL from the data or create a generic one
            const swiggyUrl = item['Restaurant URL'] || `https://www.swiggy.com/restaurants/${encodeURIComponent(item.Restaurant)}`;
            
            card.innerHTML = `
                ${imageHtml}
                <div class="p-6">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="text-xl font-semibold text-gray-800">${item.Restaurant}</h3>
                        <span class="flex items-center bg-blue-100 text-blue-800 text-sm font-medium px-2.5 py-0.5 rounded">
                            <i class="fas fa-star mr-1"></i> ${item.Rating}
                        </span>
                    </div>
                    
                    <div class="flex items-center text-gray-600 mb-3">
                        <i class="fas fa-clock mr-2"></i>
                        <span>${item['Delivery Time']}</span>
                    </div>
                    
                    <p class="text-gray-700 mb-4">${description}</p>
                    
                    <div class="flex justify-between items-center">
                        <div class="text-lg">${priceHtml}</div>
                        <a href="${swiggyUrl}" target="_blank" class="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition">
                            Order on Swiggy
                        </a>
                    </div>
                </div>
            `;
            
            return card;
        }

        function createZomatoCard(item) {
            const card = document.createElement('div');
            card.className = 'bg-white rounded-lg shadow-md overflow-hidden';
            
            let imageHtml = '';
            if (item['Image URL'] && item['Image URL'] !== "N/A") {
                imageHtml = `
                    <div class="h-48 bg-gray-200 overflow-hidden">
                        <img src="${item['Image URL']}" alt="${item.Name}" class="w-full h-full object-cover">
                    </div>
                `;
            }
            
            const cuisine = item.Cuisine ? item.Cuisine.split(', ').slice(0, 3).join(', ') : 'Various cuisines';
            const offerHtml = item.Offer && item.Offer !== "No offer" ? 
                `<span class="bg-green-100 text-green-800 text-sm font-medium px-2.5 py-0.5 rounded">${item.Offer}</span>` : '';
            
            // Get Zomato URL from the data or create a generic one
            const zomatoUrl = item['Restaurant URL'] || `https://www.zomato.com/${encodeURIComponent(item.Name)}`;
            
            card.innerHTML = `
                ${imageHtml}
                <div class="p-6">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="text-xl font-semibold text-gray-800">${item.Name}</h3>
                        <span class="flex items-center bg-green-100 text-green-800 text-sm font-medium px-2.5 py-0.5 rounded">
                            <i class="fas fa-star mr-1"></i> ${item.Rating}
                        </span>
                    </div>
                    
                    <div class="flex items-center text-gray-600 mb-1">
                        <i class="fas fa-utensils mr-2"></i>
                        <span>${cuisine}</span>
                    </div>
                    
                    <div class="flex items-center text-gray-600 mb-3">
                        <i class="fas fa-clock mr-2"></i>
                        <span>${item['Delivery Time']}</span>
                    </div>
                    
                    <div class="flex justify-between items-center mb-4">
                        <div class="text-lg font-semibold text-gray-800">${item.Price}</div>
                        ${offerHtml}
                    </div>
                    
                    <div class="flex justify-end">
                        <a href="${zomatoUrl}" target="_blank" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition">
                            Order on Zomato
                        </a>
                    </div>
                </div>
            `;
            
            return card;
        }

        function createCommonCard(swiggyItem, zomatoItem) {
            const card = document.createElement('div');
            card.className = 'bg-white rounded-lg shadow-md overflow-hidden';
            
            // Use Swiggy image if available, otherwise Zomato image
            let imageUrl = swiggyItem['Image URL'] && swiggyItem['Image URL'] !== "N/A" ? 
                swiggyItem['Image URL'] : 
                (zomatoItem['Image URL'] && zomatoItem['Image URL'] !== "N/A" ? zomatoItem['Image URL'] : null);
            
            let imageHtml = '';
            if (imageUrl) {
                imageHtml = `
                    <div class="h-48 bg-gray-200 overflow-hidden">
                        <img src="${imageUrl}" alt="${swiggyItem.Restaurant || zomatoItem.Name}" class="w-full h-full object-cover">
                    </div>
                `;
            }
            
            // Extract prices for comparison
            const swiggyPrice = parseFloat(swiggyItem['Original Price'] || swiggyItem['Discounted Price'] || '0');
            const zomatoPriceStr = zomatoItem.Price?.match(/\d+/)?.[0] || '0';
            const zomatoPrice = parseFloat(zomatoPriceStr);
            
            // Calculate price difference percentage
            let priceDifference = 0;
            let cheaperOn = 'Same';
            let priceBarPosition = '50%';
            
            if (swiggyPrice && zomatoPrice) {
                if (swiggyPrice < zomatoPrice) {
                    cheaperOn = 'Swiggy';
                    priceDifference = ((zomatoPrice - swiggyPrice) / zomatoPrice) * 100;
                    priceBarPosition = `${50 + (priceDifference / 2)}%`;
                } else if (swiggyPrice > zomatoPrice) {
                    cheaperOn = 'Zomato';
                    priceDifference = ((swiggyPrice - zomatoPrice) / swiggyPrice) * 100;
                    priceBarPosition = `${50 - (priceDifference / 2)}%`;
                }
            }
            
            // Get URLs for both platforms
            const swiggyUrl = swiggyItem['Restaurant URL'] || `https://www.swiggy.com/restaurants/${encodeURIComponent(swiggyItem.Restaurant)}`;
            const zomatoUrl = zomatoItem['Restaurant URL'] || `https://www.zomato.com/${encodeURIComponent(zomatoItem.Name)}`;
            
            card.innerHTML = `
                ${imageHtml}
                <div class="p-6">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="text-xl font-semibold text-gray-800">${swiggyItem.Restaurant || zomatoItem.Name}</h3>
                        <div class="flex space-x-2">
                            <span class="flex items-center bg-blue-100 text-blue-800 text-sm font-medium px-2.5 py-0.5 rounded">
                                <i class="fas fa-truck mr-1"></i> ${swiggyItem.Rating || 'N/A'}
                            </span>
                            <span class="flex items-center bg-green-100 text-green-800 text-sm font-medium px-2.5 py-0.5 rounded">
                                <i class="fas fa-utensils mr-1"></i> ${zomatoItem.Rating || 'N/A'}
                            </span>
                        </div>
                    </div>
                    
                    <div class="flex items-center text-gray-600 mb-3">
                        <i class="fas fa-clock mr-2"></i>
                        <span>Swiggy: ${swiggyItem['Delivery Time'] || 'N/A'} | Zomato: ${zomatoItem['Delivery Time'] || 'N/A'}</span>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="bg-indigo-50 p-3 rounded-md">
                            <h4 class="font-medium text-indigo-700 mb-1">Swiggy</h4>
                            <p class="text-gray-700 text-sm">${swiggyItem.Description || 'No description available'}</p>
                        </div>
                        <div class="bg-green-50 p-3 rounded-md">
                            <h4 class="font-medium text-green-700 mb-1">Zomato</h4>
                            <p class="text-gray-700 text-sm">${zomatoItem.Cuisine ? zomatoItem.Cuisine.split(', ').slice(0, 3).join(', ') : 'Various cuisines'}</p>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-3 bg-gray-50 rounded-md">
                        <h4 class="font-medium text-gray-700 mb-2">Price Comparison</h4>
                        
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-indigo-600 font-medium">Swiggy: ₹${swiggyPrice.toFixed(2)}</span>
                            <span class="text-gray-500 mx-2">vs</span>
                            <span class="text-green-600 font-medium">Zomato: ₹${zomatoPrice.toFixed(2)}</span>
                        </div>
                        
                        <div class="price-comparison-bar" style="background-position: ${priceBarPosition}">
                            <div class="cheaper-indicator" style="left: ${priceBarPosition}; border-top-color: ${cheaperOn === 'Swiggy' ? '#4f46e5' : cheaperOn === 'Zomato' ? '#10b981' : 'transparent'}"></div>
                        </div>
                        
                        ${cheaperOn !== 'Same' ? `
                        <div class="mt-1 text-sm text-center font-medium ${cheaperOn === 'Swiggy' ? 'text-indigo-600' : 'text-green-600'}">
                            <i class="fas fa-arrow-down mr-1"></i>
                            ${cheaperOn} is ${priceDifference.toFixed(0)}% cheaper
                        </div>
                        ` : `
                        <div class="mt-1 text-sm text-center font-medium text-gray-600">
                            <i class="fas fa-equals mr-1"></i>
                            Prices are the same
                        </div>
                        `}
                    </div>
                    
                    <div class="mt-4 flex justify-between">
                        <a href="${swiggyUrl}" target="_blank" class="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition flex-1 mr-2 text-center">
                            Order on Swiggy
                        </a>
                        <a href="${zomatoUrl}" target="_blank" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition flex-1 ml-2 text-center">
                            Order on Zomato
                        </a>
                    </div>
                </div>
            `;
            
            return card;
        }
    </script>
</body>
</html>